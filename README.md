# 🚀 desktopPyLauncher

**desktopPyLauncher** は、Windows 11 専用のデスクトップランチャーアプリです。  
ショートカット（アプリ・フォルダ・URL）、画像、動画、メモ、プロジェクトファイル(JSON) などを自由に配置し、プロジェクト単位で管理できます。

---

## 🎯 このアプリの目的

- デスクトップをアイコンで散らかしたくない人に
- ネットワークドライブが固まるから普段はアンマウントしておきたい人に
- 作業プロジェクトごとにツールや資料のショートカット配置を切り替えたい人に (markdown、動画、画像も画面内にそのまま表示できる)
- デスクトップ切り替えアプリを使うほどじゃないんだよなっていう人に（常駐しない）
- Pythonでランチャーアプリを作って自由にカスタマイズでしたい人に（たたき台として）
- 動画を並べて閲覧したい人に（チュートリアル動画やお気に入りの動画を並べて使おう。再生位置をそれぞれ保存できます）

---

## 🛠️ 使用方法と主な機能

### 📁 起動方法・プロジェクトファイル

```bash
通常起動 (ファイル指定なしの場合 default.json が読み込まれます)
python desktopPyLauncher.py

パスも指定できます
python desktopPyLauncher.py ..\myProject\default.json

スタートアップに登録して使うと便利です。（インストールのセクション参照）
```

- `.json` ファイルは **作業用のプロジェクト定義ファイル** です。
- 指定された `.json` の **あるフォルダが作業ディレクトリ** になり、相対パスも正しく解決されます。
- JSON が存在しない場合は空の新規プロジェクトとして開始できます。

---

### 🧩 アイテムの種類と操作

- デスクトップからドラッグ＆ドロップでアイテムを追加できます。
  - ドロップした直後、アイテムは編集モードになってます。
    - 編集モードを抜けるには、ツールバーから全体を編集モードにし、実行モードに切り替えます。
    - もしくはSaveしてからLoadしてください。
  - (実行モードはダブルクリックで開く・実行になります)
  - (編集モードはダブルクリックで設定画面になります)
  - 基本的にはすべてショートカットとして登録されます。
    リンク先のファイルが消されると機能しなくなります。
  - プロジェクトに保存したいテキストデータはノート機能をご利用ください。
  - 画像などは埋め込み形式(base64)に変換してプロジェクトに保存できます。
- **ショートカット（.lnk / .url）**
  - `.lnk` を含めた Windows のリンクファイルに対応
  - 自動でアイコン・タイトルを取得して表示
  - ショートカットファイルへのリンクではなく、ショートカットが参照する実体へのパスを保持するので
    ショートカットファイル自体がなくなってもプロジェクト内で有効ですが、そのショートカットが示すファイルが消されたら機能しなくなります。
	アイコンはプロジェクトで保持するようにもできます。
- **ショートカット（.exe / .py / .bat / .ps1）**
  - ダブルクリックで実行できます。ワークディレクトリは設定できます。
    実行時パラメータが必要なものはショートカットやバッチファイルなどを別途作成し利用すると良いでしょう。
- **画像（.png / .jpg など）**
  - リサイズ・明度補正付きで表示
- **動画（.mp4 など）**
  - 再生・停止・ミュート・ジャンプポイントに対応
  - 複数動画を一括コントロール可能
  - 埋め込み化はできません。ファイルの実体は保持してください。
- **ノート（プレーンテキスト / Markdown）**
  - 背景塗りつぶしや Markdown 書式対応
- **JSON データ**
  - 内容をインライン表示＆編集可能（設定ビューとして利用可）


---

### 🎨 キャンバス操作
**実行モード**
- フォルダアイコン を ダブルクリック -> エクスプローラーで開く
- プロジェクトアイコン を ダブルクリック -> プロジェクト画面切り替え
- 画像 を ダブルクリック -> 既定の画像ビューアー起動
- ビデオアイテムは、再生ボタンが各アイテムについています。
  - 画面上に複数の動画を配置し、任意の区間を一括で連続再生できます。(3区間のみ)

**編集モード**
- アイテムはドラッグで自由に移動
- 右下の「グリップ」でサイズ調整
- アイテムの削除は右クリックのコンテキストメニューからできます
- 右クリックのコンテキストメニューから、メディア（アイコン・画像・動画）のサイズににフィットできます。
- 何もない空間からドラッグ開始で**範囲選択** → 複数アイテムを一括移動可能
- ダブルクリックで各アイテムの詳細設定

---

### ✂️ コピー・ペースト機能（JSON対応）

- 選択したアイテムは **JSONテキスト** としてクリップボードに保存されます
- ペースト時には元のアイテム構造がそのまま復元されます
- 複数アイテムの **相対位置も保持** されるので、複製や他プロジェクトへの転送に便利です

---

### 🔁 履歴ナビゲーション

- 過去に開いたプロジェクトファイルを記録し、`Prev / Next / Home` ボタンで切り替え可能
- ※VideoItem を含むプロジェクトで **連続切替を高速で行うと固まることがあります**

---

### 🖱️ その他の便利な機能

- URLをドロップすると **自動でタイトル＆Faviconを取得**
- `.lnk` ファイルから **アイコン画像を抽出してBase64埋め込み**
- 背景設定機能（画像・単色・透明）あり
- 全体状態は1つの `.json` ファイルで保存・復元できます

---

## 📦 インストール

> 💻 本アプリは **Windows 11 専用** です（macOS / Linux 非対応）。

```bash
git clone https://github.com/yourname/desktopPyLauncher.git
cd desktopPyLauncher
pip install -r requirements.txt
```

### 必須ライブラリ

- **PyQt6** — GUI全体および動画／SVG描画に使用
- **markdown** — NoteアイテムのMarkdown表示に使用
- **pywin32** — `.lnk` ショートカット解析に必要（未導入だと `.lnk` は読み取れません）

---

## 📌 スタートメニューにピン留めする方法（Windows 11）

Windowsでは `.py` を直接ピン留めできないため、以下の手順で `.bat` 経由のショートカットを作成します。

1. `desktopPyLauncher.py` と同じフォルダに `.bat` ファイルを作成（例：`launch_launcher.bat`）：

    ```bat
    @echo off
    python "%~dp0desktopPyLauncher.py"
    ```

	プロジェクトファイル指定したい場合
    ```bat
    @echo off
    python "%~dp0desktopPyLauncher.py" ..\myData\myProject.json
    ```
	
2. `.bat` ファイルのショートカットを作成

3. ショートカットの「リンク先」を次のように修正：

    ```
    cmd.exe /c "C:\Path\To\launch_launcher.bat"
    ```

    ※パス全体を `" "` で囲んでください。cmd.exeは保存後パスがc:\～から補完されますがそれで大丈夫です。

4. ショートカットを右クリック →「スタートメニューにピン留め」

5. 一度起動後、タスクバーアイコンを右クリック →「タスクバーにもピン留め可能」

---

## コード・仕様につい (ご参考用)
- これは要件定義し、クラスやインターフェイスを設計し、それをAIに丸投げし、動くように修正する･･･の繰り返して作成したものです。
- クラス派生・継承でoverrideしたいわけでもないのに重複してるメソッドがあるかもしれませんが、AIの特性によるもので意図したものではありません。
- 重複した関数やメソッドなど、気が付いたものは消したり統合したほうがよいです。
- プロジェクトファイルは .json です。fileinfo のセクションがあるとプロジェクトファイルとして扱います。default.json を参考にしてください。
- 動画はコンテナ＋オーバーレイのような手法で描画をしています。Qt6的にアリなのか疑問ですが昔のWin32のような視点で諸々を解決しているので環境依存度が高いと考えられます。
  VideoItemを改良する際には、描画領域が動画と重なるとクラッシュするのでご留意ください。
- VideoItemに関し、asyncio で安定化を図る計画もありましたが、安定しなかったので現在の実装になってます。比較的安定しています。

## 構想・補足等・諸々
- コマンドプロンプトを非表示にしたい
  vbsで起動すると非表示にできます。
  さらにこれのショートカットを作って cmd /c で起動するよう書き換えればスタートメニューに登録できます。

  ```
	--------------------------
    start_launcher.vbs
	--------------------------
    Set WshShell = CreateObject("WScript.Shell")
    WshShell.Run """desktopPyLauncher.bat""", 0, False
  ```
- web-api 機能
  まだないけど、バッチファイル等のスクリプトに curl でコマンド仕込んで登録すれば現状でも可能。
  （将来的にレスポンスを読み込んで応答できるようにしたい。自分のIoT関連もこれにのせてしまいたい）
  
- ネットワーク関連
  スクリプトにネットワークドライブのマウント・アンマウントを入れて登録し、周辺にネットワークドライブ上の各フォルダのショートカットを散りばめておくと便利です。
  ```
	--------------------------
	mount_network_drives.bat
	--------------------------
	@echo off
	REM MOUNT network drives
	net use X: \\YourNAS\NAS01
	net use Y: \\YourNAS\NAS02
	net use Z: \\YourNAS\NAS01
	timeout /t 2

    --------------------------
	unmount_network_drives.bat
	--------------------------
	@echo off
	REM UNMOUNT network drives
	net use X: /delete
	net use Y: /delete
	net use Z: /delete
	timeout /t 2

  ```
  なお、本アプリはアイコンを embed 化できます。
  また、ネットワークを見に行くわけではないのでネットワークドライブがアンマウントされても固まらないのが何よりの利点。（目的の1つ）
- アプリケーションランチャー
  Pythonで作ったアプリを片っ端から登録しておくと便利です。
- とりあえず自分が使いたいので今回は日本語専用にしました。
  
## ロードマップ
- AI生成の副作用的な部分の除去・修正(重複定義とか、OOPなのに非OOP構造とか）
- ファイルの一覧表示（昔作ったランチャーには合った機能。Pythonで可能ならやる）
- サムネイラー（同上）
- ファイル操作関連（同上）
- AI関連（コスパ重視なので様子見）


## 📝 ライセンス

MIT License

---

Happy launching! 🐾
